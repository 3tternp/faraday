<!-- Faraday Penetration Test IDE -->
<!-- Copyright (C) 2013  Infobyte LLC (http://www.infobytesec.com/) -->
<!-- See the file 'doc/LICENSE' for the license information -->

<form novalidate>
    <div class="faraday-header-border-fix"></div>
    <section id="main" class="seccion clearfix">
        <div class="right-main">

            <div ng-controller="headerCtrl" ng-include="'scripts/commons/partials/header.html'"></div>
            <div id="reports-main" class="fila clearfix">

                <div class="reports col-md-12 col-sm-12 col-xs-12">
                    <div class="panel panel-default custom-panel">
                        <div class="panel-heading custom-panel-heading">To register a new agent you should enter a
                            following token
                        </div>
                        <div class="panel-body custom-panel-body">
                            <span class="agent-token-container"><code>{{newToken}}</code></span>
                            <button type="button" class="btn btn-success" title="Accept token" ng-click="acceptToken()">
                                <i class="fa fa-copy"></i> Accept and copy token
                            </button>
                            <button type="button" class="btn btn-success" title="Refresh token"
                                    ng-click="refreshToken()">
                                <i class="fa fa-refresh"></i> Refresh token
                            </button>
                        </div>

                    </div>


                    <table id="agent-table" class="table-v3 table table-responsive">
                        <thead>
                        <tr class="ui-grid-header">
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Type</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Status</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Token</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Description</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Version</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Projects</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Jobs</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell">Tags</th>
                            <th class="ui-grid-cell-contents ui-grid-header-cell"></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="agent in agents">
                            <td class="ui-grid-cell-contents active-toggle">
                                <span class="preview-tag" ng-class="{'tag-blue':agent.type=='shared', 'tag-green':agent.type=='specific'}">{{agent.type}}</span>
                            </td>
                            <td class="ui-grid-cell-contents active-toggle">
                                <span class="preview-tag" ng-class="{'tag-yellow':agent.status=='locked',
                                'tag-green':agent.status=='running',
                                'tag-red':agent.status=='paused','tag-gray':agent.status=='offline'}">{{agent.status}}</span>
                            </td>

                            <td class="ui-grid-cell-contents active-toggle">
                                {{agent.token | limitTo: 8}}
                            </td>

                            <td class="ui-grid-cell-contents active-toggle">
                                {{agent.description}}
                            </td>

                            <td class="ui-grid-cell-contents active-toggle">
                                {{agent.version}}
                            </td>

                            <td class="ui-grid-cell-contents active-toggle">
                                {{agent.projects}}
                            </td>

                            <td class="ui-grid-cell-contents active-toggle">
                                {{agent.jobs}}
                            </td>

                            <td class="ui-grid-cell-contents active-toggle">
                                <span class="preview-tag tag-blue" ng-repeat="tag in agent.tags">{{tag}}</span>
                            </td>


                            <td class="ui-grid-cell-contents active-toggle">
                                <button type="button" class="btn" ng-class="{'btn-danger': agent.status === 'running', 'btn-success': agent.status === 'paused'}"
                                        title="{{agent.status === 'running'?'Pause Agent': 'Run Agent'}}" ng-click="changeStatusAgent(agent)">
                                    <span ng-bind="agent.status === 'running'?'Pause': 'Run'"></span>
                                </button>
                                <button type="button" class="btn btn-danger" title="Remove Agent" ng-click="removeAgent(agent.id)">
                                    Remove
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table><!-- #hosts -->

                    <div class="no-info-overlay" ng-if="agents.length === 0" style="margin-bottom: 15px;top: -8px;">
                        <p class="no-info-text">
                            No registered agents
                        </p>
                    </div>

                </div><!-- .reports -->
            </div><!-- #reports-main --></div><!-- .right-main -->
    </section><!-- #main -->
</form>
